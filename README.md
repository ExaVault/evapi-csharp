# ExaVault API SDK for C# v.20 

## Introduction
Welcome to ExaVault's C# code library for our v2 API.  Use our API to interact with all aspects of the service the same way our web portal would. The library is generated from our API's [public swagger YAML file](https://www.exavault.com/api/docs/evapi_2.0_public.yaml)


## Requirements
To use the SDK, you'll need Visual Studio installed as well as .Net Framework 4.0 or later.

You will also need an ExaVault account as well as and an API key and access token.

## Using the SDK
**Step 1 - Adding the code to your project**

- Clone the repository to your local machine

  ```bash
  $ git clone git@github.com:ExaVault/evapi-csharp.git
  ```

*Alternatively, you can include the dlls generated by this project by copying `bin\Release` [folder onto your local computer](https://github.com/ExaVault/evapi-csharp-samples/tree/main/Example/bin/Release) and add all dlls in this folder as reference into your own project. You would need to edit your App.config or Web.config file to include your API credentials. Then, you can add the related class and test it.*

**Step 2 - Get your API Credentials**

The next step is to generate an API key and token from your ExaVault account. You'll need to log into the ExaVault web file manager, as an admin-level user, to get the API key and access token. See [our API reference documentation](https://www.exavault.com/developer/api-docs/v2/#section/Obtaining-Your-API-Key-and-Access-Token) for the step-by-step guide to create your key and/or token.

If you are not an admin-level user of an ExaVault account, you'll need someone with admin-level access to follow the steps and give you the API key and access token.

**Step 3 - Add Your API Credentials to the sample code**

You need to add your API credentials into the App.config file. Edit this file like below.

```bash
  <appSettings>
    <add key="ACCOUNT_URL" value="https://your_account_name.exavault.com/api/v2"/>
    <add key="EV_KEY" value="your_key_here"/>
    <add key="EV_TOKEN" value="your_access_token"/>
  </appSettings>
```

- replace **your\_key\_here** with your API key. Don't add any extra spaces or punctuation
- replace **your\_token\_here** with your access token.
- replace **your\_account_name** with the name of your ExaVault account

And save the file.

**Step 4 - Use the library**

```csharp
using System;
using System.Diagnostics;
using IO.Swagger.Api;
using IO.Swagger.Client;
using IO.Swagger.Model;

namespace Example
{
    public class Example
    {
        public void main()
        {
            var apiInstance = new AccountApi();
            var evApiKey = ConfigurationManager.AppSettings["EV_KEY"];  // string | API Key required for the request
            var evAccessToken = ConfigurationManager.AppSettings["EV_TOKEN"];  // string | Access Token for the request
            var evAccountUrl = ConfigurationManager.AppSettings["ACCOUNT_URL"];  // string | API URL for the request
            var include = "masterUser";  // string | Related records to include in the response. Valid option is **masterUser** (optional) 

            try
            {
                // Get account settings
                AccountResponse result = apiInstance.GetAccount(evApiKey, evAccessToken, include);
                Debug.WriteLine(result);
            }
            catch (Exception e)
            {
                Debug.Print("Exception when calling AccountApi.GetAccount: " + e.Message );
            }
        }
    }
}
```

## If Something Goes Wrong

**Problem - The type or namespace name '???' does not exist in the namespace **

An assembly could be missing. Please check your references to see if there is any yellow marked reference. If so, the package may not be the latest version. We recommend using NuGet to obtain the latest version of the packages.

```bash
Install-Package RestSharp
Install-Package Newtonsoft.Json
Install-Package JsonSubTypes
```

**Problem - 401 Unauthorized Response**

If running the sample script returns a 401 Unauthorized error like the one shown below, there is a problem with your API credentials. Double-check that the .env file exists and contains the correct values. If all else fails, you may need to log into the ExaVault web file manager and re-issue your access token.

```bash
Exception when calling AccountApi->getAccount: [401] Client error: `GET https://exavaultsupport.exavault.com/api/v2/account` resulted in a `401 Unauthorized` response:
{"responseStatus":401,"errors":[{"code":"ERROR_INVALID_CREDENTIALS","detail":"HTTP_UNAUTHORIZED"}]}
```

**Other problems with sample code**

If you encounter any other issues running this sample code, you can contact ExaVault support for help at support@exavault.com.

## Writing Your Own Code

When you're ready to write your own code, you can use our sample code as examples. You'll need to:

1. Install our code packages by downloading from  `bin\Release` folder or following the steps above.
2. You can use the App.config or Web.config depending on your project just like our sample scripts do, or just set variables within your scripts for your API key and access token
3. Whenever you instantiate an Api object (ResourcesApi, UsersApi, etc.), override the configuration to point the code at the correct API URL:
```C#
var evAccountUrl  = "https://YOUR_ACCOUNT_NAME_HERE.exavault.com/api/v2/";
var accountApi = new AccountApi(evAccountUrl);
```
```C#
var evAccountUrl  = "https://YOUR_ACCOUNT_NAME_HERE.exavault.com/api/v2/";
var resourcesApi = new ResourcesApi(evAccountUrl);
```
```C#
var evAccountUrl  = "https://YOUR_ACCOUNT_NAME_HERE.exavault.com/api/v2/";
var usersApi = new UsersApi(evAccountUrl);
```

## Author

support@exavault.com

